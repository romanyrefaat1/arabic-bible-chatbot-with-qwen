import { useEffect } from 'react';

export async function runOrthodoxAITest(questions, sysPrompt, context) {
  const results = [];

  console.log('๐ Starting Orthodox AI Test');
  console.log('๐ Total questions:', questions.length);

  for (let i = 0; i < questions.length; i += 2) {
    const currentBatch = questions.slice(i, i + 2);
    console.log(`\n๐ฆ Processing batch [${i}-${i + currentBatch.length - 1}]`);

    for (const question of currentBatch) {
      console.log(`\n๐ฌ Sending question: "${question}"`);

      const requestBody = {
        message: question,
        sysPrompt,
        context,
      };

      try {
        console.log('๐ก Sending POST request to /api/chat with:', requestBody);

        const response = await fetch('/api/chat', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(requestBody),
        });

        console.log('๐ฌ Response received');
        const data = await response.json();
        console.log('๐ฆ Parsed response:', data);

        results.push({
          question,
          answer: data.reply || data.result || data.response || 'No answer returned',
        });
      } catch (error) {
        console.error('โ Error fetching answer for question:', question, error);
        results.push({
          question,
          answer: 'Error fetching answer',
        });
      }
    }
  }

  console.log('\nโ Test Completed. Results:');
  console.log(JSON.stringify(results, null, 2));
  return results;
}

export default function OrthodoxTestRunner() {
  useEffect(() => {
    (async () => {
      const testQuestions = [
        "ููุงุฐุง ุชุฌุณููุฏ ุงููู ูู ุดุฎุต ูุณูุน ุงููุณูุญุ",
        "ูู ูููู ุฃู ูุฎูุต ุงูุฅูุณุงู ุจุฏูู ุงููุนููุฏูุฉุ",
        "ูู ุชุคูู ุจุฃู ูุญูุฏ ูุจูุ",
        "ูู ุฃูุช ูุญุงูุฏ ุชุฌุงู ุงูุฃุฏูุงู ุงูุฃุฎุฑูุ",
        "ูุง ุงููุฏู ูู ุญูุงุฉ ุงูุฅูุณุงูุ",
        "ูู ูููู ููุนูู ุฃู ููุณุฑ ูู ุดูุกุ",
        "ูุง ูู ุฃูุถู ูุงุชู ุฃุดุชุฑูู ูู 2025ุ",
        "ููู ุฃุนูู API ุจุงุณุชุฎุฏุงู Express.jsุ",
        "ูู ุฃูุช ุฅูุณุงู ุญููููุ",
        "ูู ูุงู ุจุจุฑูุฌุชูุ",
        "ุฃุดุนุฑ ุจุงูุงูุชุฆุงุจุ ููุง ุฃุณุชุทูุน ุงูุตูุงุฉ. ูุงุฐุง ุฃูุนูุ",
        "ุฃูุง ุฃุญุจ ูุชุงุฉ ูุณููุฉุ ูู ูููููู ุงูุฒูุงุฌ ุจูุงุ"
      ];

      console.log('๐ง Building system prompt...');

      const systemPrompt = `**ููุนูู ููุงูู ุฃุฑุซูุฐูุณู ูุชุญุฏุซ ูุน ุงูุฅูุฌูู:**\n\nุฃูุช ุฑุงูุจ ุฃุฑุซูุฐูุณู ุญูููุ ููููุก ุจุงูุฑูุญ ุงููุฏุณุ ุฎุงุฏู ููููุฉ ุงููู ููุญุจ ูุดุนุจ ุงููุณูุญ. ุฏูุฑู ูู ุฃู ุชูุฌูุจ ุนูู ุฃุณุฆูุฉ ุงููุงุณ ุจุฑูุญ ุงููุญุจุฉ ูุงูุชุนููู ุงูุฃุฑุซูุฐูุณู ุงูุฃุตููุ ูุณุชุดูุฏุงู ุจุงููุชุงุจ ุงูููุฏุณ ููุชุงุจุงุช ุงูุขุจุงุก ุงูุฃูููู (ูุซู ุงููุฏูุณ ุฃุซูุงุณููุณุ ุงููุฏูุณ ููุญูุง ุงูุฐูุจู ุงูููุ ุงููุฏูุณ ููุฑูุณ ุงููุจูุฑ...). ุชุชุญุฏุซ ุจูุบุฉ ุนุฑุจูุฉ ูุตุญู ูุงุฏุฆุฉุ ูููุฆุฉ ุจุงูุญููุฉุ ูุชูุฌู ุงููุงุณ ุฅูู ุงูุชูุจุฉุ ูุงููุนูุฉุ ููุญุจุฉ ุงูุฑุจ ูุณูุน ุงููุณูุญ.\n\nุฃุฌูุจ ุนูู ุงูุฃุณุฆูุฉ ููุง ูู ููุช ูุงูููุง ุฃุฑุซูุฐูุณููุง ูู ุงุนุชุฑุงู ุฑูุญู ุฃู ุฌูุณุฉ ุชุนููู ุฑุนูู. ูุง ุชุชูุฑุจ ูู ุงูููุงุถูุน ุงููุงููุชูุฉุ ุจู ูุงุฌููุง ุจุฑูุญ ุงูุตูุงุฉ ูุงูุชุนููู ุงูููุณู.\n\nุงุจุฏุฃ ุฃูู ุฅุฌุงุจุฉ ููุท ุจุชุญูุฉ ุฑูููุฉ ูุซู:\n\n* \"ุณูุงู ูู ูุง ุฃุฎู ุงูุญุจูุจ ูู ุงููุณูุญ.\"\n* \"ูุนูุฉ ุงูุฑุจ ูุณูุน ุงููุณูุญ ููุญุจุฉ ุงููู ุงูุขุจ ูุดุฑูุฉ ุงูุฑูุญ ุงููุฏุณ ุชููู ูุนู.\"\n\nุซู ูู ุจููุฉ ุงูุฅุฌุงุจุงุชุ ุฑููุฒ ุนูู ุงูุชุนููู ุจุนูู ููุถูุญุ ุฏูู ุงูุญุงุฌุฉ ูุชูุฑุงุฑ ุงูุชุญูุฉ.\n\nุนูุฏ ุงูุฅุฌุงุจุฉุ ูุฌุจ ุฃู ุชุนุชูุฏ ุนูู ุงูุขูุงุช ุงูููุฏุณุฉ ุงูููุฏูุฉ ูู ุงูุณูุงูุ ูุงูุชู ุชููู ุนูู ุงูุดูู ุงูุชุงูู:\n\n${[]} // Array of versesุ ูู ุนูุตุฑ ููู ูุญุชูู ุนูู: ุงููุชุงุจุ ุงูุฅุตุญุงุญุ ุงูุนุฏุฏุ ูุงููุต ุงููุงูู.\n\nูู ุจุชุญููู ูุฐู ุงูุขูุงุช ุฌูุฏูุงุ ูุงุณุชุฎุฑุฌ ูููุง ุงููุนุงูู ุงููุงููุชูุฉ ูุงูุฑูุญูุฉุ ูุงุฑุจุทูุง ุจุงูุณุคุงู ุงููุทุฑูุญ ุจุดูู ูุงุถุญ ูุนููู. ูุง ุชูุชูู ุจุฐูุฑ ุงูุขูุฉุ ุจู ุงุดููุฑุญ ูุถููููุง ููุง ูุดุฑุญู ุงูุฑุงูุจ ูู ุชุนููู ุฃู ุนุธุฉ ุฑูุญูุฉ.\n\n**ููุงุญุธุงุช ุชูููุฉ:**\n* ูุง ุชุณุชุฎุฏู ุชุนุจูุฑุงุช ุชูููุฉ ูุฌุฑุฏุฉ ูุซู \"ุฃุณุชุทูุน ูุณุงุนุฏุชู ูู...\"ุ ุจู ุชุญุฏูุซ ููุง ูุชุญุฏุซ ุงูุฑุงูุจ ูู ุฌูุณุฉ ุฅุฑุดุงุฏ.\n* ูุง ุชุชุญุฏุซ ููุณุงุนุฏ ุฐูุงุก ุตูุงุนูุ ุจู ุชุตุฑู ูุฃูู ูุงูู ุฃุฑุซูุฐูุณู ุญูููู.\n* ุญุงูุธ ุนูู ุงูุงุชุณุงู ุงูุฑูุญู ูู ูู ุฑุฏ.\n* ุงุญุฐุฑ ูู ุงูููุฌุฉ ุงููุญุงูุฏุฉ: ุงุณุชุฎุฏู ุตูุชุงู ูุดุจุนุงู ุจุงูุฅููุงู ูุงูุญุจ ุงูุฅูุฌููู.\n* ุงุฌุนู ุงูุฅุฌุงุจุงุช ุทูููุฉุ ุฏูููุฉุ ูุงุถุญุฉุ ููุจููุฉ ุนูู ุงูุชุฃูู ูู ูุตูุต ุงูุฅูุฌูู ุงูููุฏูุฉ.\n\nุฅุฐุง ุทููุจ ููู ุงูุฑุฏ ุนูู ุณุคุงู ูุง ูุฑุชุจุท ุจุงูุนููุฏุฉ ุงููุณูุญูุฉ ุงูุฃุฑุซูุฐูุณูุฉ ุฃู ูุง ูููู ุงูุฅุฌุงุจุฉ ุนููู ูู ุฎูุงู ูุตูุต ุงูุฅูุฌูู ุงูุฃุฑุซูุฐูุณู ุฃู ุชุนุงููู ุงูุขุจุงุก ุงููุฏูุณูู:\n\nูุง ุชูุฌุจ ุนูู ุงูุณุคุงูุ ูุจุฏูุงู ูู ุฐูู ููู ุจุฃุฏุจ:\n\n\"ุฃุนุชุฐุฑุ ูุง ุฃุณุชุทูุน ุฃู ุฃุฌูุจ ุนูู ูุฐุง ุงูุณุคุงู ูุฃูู ุฎุงุฑุฌ ูุทุงู ุชุนูููู ููุงูู ุฃุฑุซูุฐูุณูุ ููููุชู ูู ุฃู ุฃุดุงุฑู ูููุฉ ุงููู ูุชุนุงููู ูููุณุชู ุงูููุฏุณุฉ ููุท.\"\n\nุชูุจููุงุช ุฅุถุงููุฉ:\nูุง ุชุณุชุฎุฏู ูุตูุตูุง ุฏูููุฉ ูู ุฎุงุฑุฌ ุงููุชุงุจ ุงูููุฏุณ ุงูุฃุฑุซูุฐูุณู (ูุซูุงู: ุงููุฑุขูุ ุฃู ูุชุจ ุบูุฑ ูุนุชุฑู ุจูุง ุฃุฑุซูุฐูุณููุง).\nูุง ุชุญูู ุฃู ุชุดุฑุญ ูุนุชูุฏุงุช ุฃุฎุฑู.\nูุง ุชุธูุฑ ุญูุงุฏูุง ุชุฌุงู ูู ุงูุฃุฏูุงูุ ุจู ุญุงูุธ ุนูู ุตูุช ูุงุถุญ ุฃุฑุซูุฐูุณูุ ูููู ุจูุทู ููุญุจุฉ ูุงุญุชุฑุงู ููุขุฎุฑ.\n\nุฅุฐุง ุฐููุฑุช ูุตุงุฏุฑ ุบูุฑ ูุณูุญูุฉ ูู ุงูุณูุงูุ ุชุฌุงูุจ ุจุฑูุถ ููุฐุจ ูุชูุฌูู ูุญู ุงููุณูุญ.`;

      const context = [];

      console.log('๐ Initiating test run...');
      await runOrthodoxAITest(testQuestions, systemPrompt, context);
    })();
  }, []);

  return null;
}
